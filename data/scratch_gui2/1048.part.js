/* 1048 */\n (function(module, exports, __webpack_require__) {\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\nvar formatMessage = __webpack_require__(71);\nvar nets = __webpack_require__(223);\nvar languageNames = __webpack_require__(449);\nvar ArgumentType = __webpack_require__(63);\nvar BlockType = __webpack_require__(45);\nvar Cast = __webpack_require__(48);\nvar MathUtil = __webpack_require__(62);\nvar Clone = __webpack_require__(113);\nvar log = __webpack_require__(39);\n/**\n * Icon svg to be displayed in the blocks category menu, encoded as a data URI.\n * @type {string}\n */\n\nvar menuIconURI = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjBweCIgaGVpZ2h0PSIyMHB4IiB2aWV3Qm94PSIwIDAgMjAgMjAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjIgKDY3MTQ1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5FeHRlbnNpb25zL1NvZnR3YXJlL1RleHQtdG8tU3BlZWNoLU1lbnU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iRXh0ZW5zaW9ucy9Tb2Z0d2FyZS9UZXh0LXRvLVNwZWVjaC1NZW51IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0idGV4dDJzcGVlY2giIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuMDAwMDAwLCAyLjAwMDAwMCkiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik01Ljc1LDguODM0NjcxNzMgQzUuNzUsOC4zMjY5NjM0NCA1LjAwMzAwNzI3LDguMDQyMjEzNzEgNC41NTYyODAxMiw4LjQ0NDE0OTk5IEwzLjIwNjI4MDEyLDkuNTI1MzU3MDIgQzIuNjk2NzMzNzgsOS45MzM0NDk2OCAyLjAzNzQ4Njc1LDEwLjE2NTg3ODggMS4zNSwxMC4xNjU4Nzg4IEwxLjE1LDEwLjE2NTg3ODggQzAuNjMyNTk2MTY1LDEwLjE2NTg3ODggMC4yNSwxMC41MTA2MDAyIDAuMjUsMTAuOTUyMDM1NSBMMC4yNSwxMy4wNjkzOTkzIEMwLjI1LDEzLjUxMDgzNDYgMC42MzI1OTYxNjUsMTMuODU1NTU2IDEuMTUsMTMuODU1NTU2IEwxLjM1LDEzLjg1NTU1NiBDMi4wNzg3Nzg0MSwxMy44NTU1NTYgMi43MjY4NjE2MSwxNC4wNjY3NjM2IDMuMjU5ODYwNDksMTQuNDk5IEw0LjU1OTIwMTQ3LDE1LjU3OTY2MDggQzUuMDEzMDkyNzYsMTUuOTU0NTM5NiA1Ljc1LDE1LjY3MzYzNDQgNS43NSwxNS4xNDE3MTI4IEw1Ljc1LDguODM0NjcxNzMgWiIgaWQ9InNwZWFrZXIiIHN0cm9rZS1vcGFjaXR5PSIwLjE1IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMC41IiBmaWxsPSIjNEQ0RDREIj48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC43MDQ4MzEzLDggQzkuNzkwNjc0NjgsOS4xMzExNDg0NyA4LjMwNjYxODQsOS43MTQyODU3MSA3LjgzMzMzMzMzLDkuNzE0Mjg1NzEgQzcuODMzMzMzMzMsOS43MTQyODU3MSA3LjUsOS43MTQyODU3MSA3LjUsOS4zODA5NTIzOCBDNy41LDkuMDg1MjI2ODQgOC4wNjIyMDE2OCw4LjkwMTk0MTY0IDguMTg5MDYwNjcsNy41Njc1NDA1OCBDNi44ODk5Njk5MSw2LjkwNjc5MDA1IDYsNS41NTczMjY4MyA2LDQgQzYsMS43OTA4NjEgNy43OTA4NjEsNC4wNTgxMjI1MWUtMTYgMTAsMCBMMTIsMCBDMTQuMjA5MTM5LC00LjA1ODEyMjUxZS0xNiAxNiwxLjc5MDg2MSAxNiw0IEMxNiw2LjIwOTEzOSAxNC4yMDkxMzksOCAxMiw4IEwxMC43MDQ4MzEzLDggWiIgaWQ9InNwZWVjaCIgZmlsbD0iIzBFQkQ4QyI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+';\n/**\n * Icon svg to be displayed at the left edge of each extension block, encoded as a data URI.\n * @type {string}\n */\n\nvar blockIconURI = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjIgKDY3MTQ1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5FeHRlbnNpb25zL1NvZnR3YXJlL1RleHQtdG8tU3BlZWNoLUJsb2NrPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkV4dGVuc2lvbnMvU29mdHdhcmUvVGV4dC10by1TcGVlY2gtQmxvY2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZS1vcGFjaXR5PSIwLjE1Ij4KICAgICAgICA8ZyBpZD0idGV4dDJzcGVlY2giIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQuMDAwMDAwLCA0LjAwMDAwMCkiIGZpbGwtcnVsZT0ibm9uemVybyIgc3Ryb2tlPSIjMDAwMDAwIj4KICAgICAgICAgICAgPHBhdGggZD0iTTExLjUsMTcuNjY5MzQzNSBDMTEuNSwxNi42NTM5MjY5IDEwLjAwNjAxNDUsMTYuMDg0NDI3NCA5LjExMjU2MDI0LDE2Ljg4ODMgTDYuNDEyNTYwMjQsMTkuMDUwNzE0IEM1LjM5MzQ2NzU1LDE5Ljg2Njg5OTQgNC4wNzQ5NzM1MSwyMC4zMzE3NTc1IDIuNywyMC4zMzE3NTc1IEwyLjMsMjAuMzMxNzU3NSBDMS4yNjUxOTIzMywyMC4zMzE3NTc1IDAuNSwyMS4wMjEyMDAzIDAuNSwyMS45MDQwNzEgTDAuNSwyNi4xMzg3OTg2IEMwLjUsMjcuMDIxNjY5MyAxLjI2NTE5MjMzLDI3LjcxMTExMiAyLjMsMjcuNzExMTEyIEwyLjcsMjcuNzExMTEyIEM0LjE1NzU1NjgyLDI3LjcxMTExMiA1LjQ1MzcyMzIyLDI4LjEzMzUyNzEgNi41MTk3MjA5OCwyOC45OTggTDkuMTE4NDAyOTMsMzEuMTU5MzIxNiBDMTAuMDI2MTg1NSwzMS45MDkwNzkzIDExLjUsMzEuMzQ3MjY4OSAxMS41LDMwLjI4MzQyNTUgTDExLjUsMTcuNjY5MzQzNSBaIiBpZD0ic3BlYWtlciIgZmlsbD0iIzRENEQ0RCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMjEuNjQzNjA2NiwxNi41IEMxOS45NzcwMDk5LDE4LjQzNzAyMzQgMTcuMTA1MDI3NSwxOS45Mjg1NzE0IDE1LjY2NjY2NjcsMTkuOTI4NTcxNCBDMTUuNTEyNjM5NywxOS45Mjg1NzE0IDE1LjMxNjYyOTIsMTkuODk1OTAzIDE1LjEwOTcyNjUsMTkuNzkyNDUxNyBDMTQuNzM3NjAzOSwxOS42MDYzOTA0IDE0LjUsMTkuMjQ5OTg0NiAxNC41LDE4Ljc2MTkwNDggQzE0LjUsMTguNjU2ODA0MSAxNC41MTcwNTU1LDE4LjU1NDUwNzYgMTQuNTQ5NDQ2NywxOC40NTQwODQ0IEMxNC42MjU3NTQ1LDE4LjIxNzUwNjMgMTUuMTczNTcyMSwxNy40Njc1MzEgMTUuMjc3MjA3MSwxNy4yODA5ODgxIEMxNS41NDYzNTI2LDE2Ljc5NjUyNjEgMTUuNzM5MDI1LDE2LjIwNjM1NjEgMTUuODQzMjg5MSwxNS40MTYwMDM0IEMxMy4xODk3MDA1LDEzLjkyNjgzNjkgMTEuNSwxMS4xMTM5NjY4IDExLjUsOCBDMTEuNSwzLjMwNTU3OTYzIDE1LjMwNTU3OTYsLTAuNSAyMCwtMC41IEwyNCwtMC41IEMyOC42OTQ0MjA0LC0wLjUgMzIuNSwzLjMwNTU3OTYzIDMyLjUsOCBDMzIuNSwxMi42OTQ0MjA0IDI4LjY5NDQyMDQsMTYuNSAyNCwxNi41IEwyMS42NDM2MDY2LDE2LjUgWiIgaWQ9InNwZWVjaCIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+';\n/**\n * The url of the synthesis server.\n * @type {string}\n */\nvar SERVER_HOST = 'https://synthesis-service.scratch.mit.edu';\n/**\n * How long to wait in ms before timing out requests to synthesis server.\n * @type {int}\n */\nvar SERVER_TIMEOUT = 10000; \n/**\n * Volume for playback of speech sounds, as a percentage.\n * @type {number}\n */\nvar SPEECH_VOLUME = 250;\n/**\n * An id for one of the voices.\n */\nvar ALTO_ID = 'ALTO';\n/**\n * An id for one of the voices.\n */\nvar TENOR_ID = 'TENOR';\n/**\n * An id for one of the voices.\n */\nvar SQUEAK_ID = 'SQUEAK';\n/**\n * An id for one of the voices.\n */\nvar GIANT_ID = 'GIANT';\n/**\n * An id for one of the voices.\n */\nvar KITTEN_ID = 'KITTEN';\n/**\n * Playback rate for the tenor voice, for cases where we have only a female gender voice.\n */\nvar FEMALE_TENOR_RATE = 0.89; \n/**\n * Playback rate for the giant voice, for cases where we have only a female gender voice.\n */\nvar FEMALE_GIANT_RATE = 0.79; \n/**\n * Language ids. The value for each language id is a valid Scratch locale.\n */\nvar ARABIC_ID = 'ar';\nvar CHINESE_ID = 'zh-cn';\nvar DANISH_ID = 'da';\nvar DUTCH_ID = 'nl';\nvar ENGLISH_ID = 'en';\nvar FRENCH_ID = 'fr';\nvar GERMAN_ID = 'de';\nvar HINDI_ID = 'hi';\nvar ICELANDIC_ID = 'is';\nvar ITALIAN_ID = 'it';\nvar JAPANESE_ID = 'ja';\nvar KOREAN_ID = 'ko';\nvar NORWEGIAN_ID = 'nb';\nvar POLISH_ID = 'pl';\nvar PORTUGUESE_BR_ID = 'pt-br';\nvar PORTUGUESE_ID = 'pt';\nvar ROMANIAN_ID = 'ro';\nvar RUSSIAN_ID = 'ru';\nvar SPANISH_ID = 'es';\nvar SPANISH_419_ID = 'es-419';\nvar SWEDISH_ID = 'sv';\nvar TURKISH_ID = 'tr';\nvar WELSH_ID = 'cy';\n/**\n * Class for the text2speech blocks.\n * @constructor\n */\nvar Scratch3Text2SpeechBlocks = function () {\n  function Scratch3Text2SpeechBlocks(runtime) {\n    _classCallCheck(this, Scratch3Text2SpeechBlocks);\n   \n    this.runtime = runtime;\n   \n    this._soundPlayers = new Map();\n    this._stopAllSpeech = this._stopAllSpeech.bind(this);\n    if (this.runtime) {\n      this.runtime.on('PROJECT_STOP_ALL', this._stopAllSpeech);\n    }\n    this._onTargetCreated = this._onTargetCreated.bind(this);\n    if (this.runtime) {\n      runtime.on('targetWasCreated', this._onTargetCreated);\n    }\n   \n    this._supportedLocales = this._getSupportedLocales();\n  }\n \n  _createClass(Scratch3Text2SpeechBlocks, [{\n    key: \"_getState\",\n   \n    value: function _getState(target) {\n      var state = target.getCustomState(Scratch3Text2SpeechBlocks.STATE_KEY);\n      if (!state) {\n        state = Clone.simple(Scratch3Text2SpeechBlocks.DEFAULT_TEXT2SPEECH_STATE);\n        target.setCustomState(Scratch3Text2SpeechBlocks.STATE_KEY, state);\n      }\n      return state;\n    }\n   \n  }, {\n    key: \"_onTargetCreated\",\n    value: function _onTargetCreated(newTarget, sourceTarget) {\n      if (sourceTarget) {\n        var state = sourceTarget.getCustomState(Scratch3Text2SpeechBlocks.STATE_KEY);\n        if (state) {\n          newTarget.setCustomState(Scratch3Text2SpeechBlocks.STATE_KEY, Clone.simple(state));\n        }\n      }\n    }\n   \n  }, {\n    key: \"getInfo\",\n    value: function getInfo() {\n      \n      \n      var defaultTextToSpeak = 'hello';\n      if (this.isSupportedLanguage(this.getEditorLanguage())) {\n        defaultTextToSpeak = formatMessage({\n          id: 'text2speech.defaultTextToSpeak',\n          default: 'hello',\n          description: 'hello: the default text to speak'\n        });\n      }\n      return {\n        id: 'text2speech',\n        name: formatMessage({\n          id: 'text2speech.categoryName',\n          default: 'Text to Speech',\n          description: 'Name of the Text to Speech extension.'\n        }),\n        blockIconURI: blockIconURI,\n        menuIconURI: menuIconURI,\n        blocks: [{\n          opcode: 'speakAndWait',\n          text: formatMessage({\n            id: 'text2speech.speakAndWaitBlock',\n            default: 'speak [WORDS]',\n            description: 'Speak some words.'\n          }),\n          blockType: BlockType.COMMAND,\n          arguments: {\n            WORDS: {\n              type: ArgumentType.STRING,\n              defaultValue: defaultTextToSpeak\n            }\n          }\n        }, {\n          opcode: 'setVoice',\n          text: formatMessage({\n            id: 'text2speech.setVoiceBlock',\n            default: 'set voice to [VOICE]',\n            description: 'Set the voice for speech synthesis.'\n          }),\n          blockType: BlockType.COMMAND,\n          arguments: {\n            VOICE: {\n              type: ArgumentType.STRING,\n              menu: 'voices',\n              defaultValue: ALTO_ID\n            }\n          }\n        }, {\n          opcode: 'setLanguage',\n          text: formatMessage({\n            id: 'text2speech.setLanguageBlock',\n            default: 'set language to [LANGUAGE]',\n            description: 'Set the language for speech synthesis.'\n          }),\n          blockType: BlockType.COMMAND,\n          arguments: {\n            LANGUAGE: {\n              type: ArgumentType.STRING,\n              menu: 'languages',\n              defaultValue: this.getCurrentLanguage()\n            }\n          }\n        }],\n        menus: {\n          voices: {\n            acceptReporters: true,\n            items: this.getVoiceMenu()\n          },\n          languages: {\n            acceptReporters: true,\n            items: this.getLanguageMenu()\n          }\n        }\n      };\n    }\n   \n  }, {\n    key: \"getEditorLanguage\",\n    value: function getEditorLanguage() {\n      var locale = formatMessage.setup().locale || navigator.language || navigator.userLanguage || this.DEFAULT_LANGUAGE;\n      return locale.toLowerCase();\n    }\n   \n  }, {\n    key: \"getCurrentLanguage\",\n    value: function getCurrentLanguage() {\n      var stage = this.runtime.getTargetForStage();\n      if (!stage) return this.DEFAULT_LANGUAGE; \n      if (!stage.textToSpeechLanguage) {\n        this.setCurrentLanguage(this.getEditorLanguage());\n      }\n      return stage.textToSpeechLanguage;\n    }\n   \n  }, {\n    key: \"setCurrentLanguage\",\n    value: function setCurrentLanguage(locale) {\n      var stage = this.runtime.getTargetForStage();\n      if (!stage) return;\n      if (this.isSupportedLanguage(locale)) {\n        stage.textToSpeechLanguage = this._getExtensionLocaleForSupportedLocale(locale);\n      } \n      \n      \n      var localeForDroppedName = languageNames.nameMap[locale.toLowerCase()];\n      if (localeForDroppedName && this.isSupportedLanguage(localeForDroppedName)) {\n        stage.textToSpeechLanguage = this._getExtensionLocaleForSupportedLocale(localeForDroppedName);\n      } \n      \n      \n      if (!stage.textToSpeechLanguage) {\n        stage.textToSpeechLanguage = this.DEFAULT_LANGUAGE;\n      }\n    }\n   \n  }, {\n    key: \"_getExtensionLocaleForSupportedLocale\",\n    value: function _getExtensionLocaleForSupportedLocale(locale) {\n      for (var lang in this.LANGUAGE_INFO) {\n        if (this.LANGUAGE_INFO[lang].locales.includes(locale)) {\n          return lang;\n        }\n      }\n      log.error(\"cannot find extension locale for locale \".concat(locale));\n    }\n   \n  }, {\n    key: \"_getSpeechSynthLocale\",\n    value: function _getSpeechSynthLocale() {\n      var speechSynthLocale = this.LANGUAGE_INFO[this.DEFAULT_LANGUAGE].speechSynthLocale;\n      if (this.LANGUAGE_INFO[this.getCurrentLanguage()]) {\n        speechSynthLocale = this.LANGUAGE_INFO[this.getCurrentLanguage()].speechSynthLocale;\n      }\n      return speechSynthLocale;\n    }\n   \n  }, {\n    key: \"_getSupportedLocales\",\n    value: function _getSupportedLocales() {\n      var _this = this;\n      return Object.keys(this.LANGUAGE_INFO).reduce(function (acc, lang) {\n        return acc.concat(_this.LANGUAGE_INFO[lang].locales);\n      }, []);\n    }\n   \n  }, {\n    key: \"isSupportedLanguage\",\n    value: function isSupportedLanguage(languageCode) {\n      return this._supportedLocales.includes(languageCode);\n    }\n   \n  }, {\n    key: \"getVoiceMenu\",\n    value: function getVoiceMenu() {\n      var _this2 = this;\n      return Object.keys(this.VOICE_INFO).map(function (voiceId) {\n        return {\n          text: _this2.VOICE_INFO[voiceId].name,\n          value: voiceId\n        };\n      });\n    }\n   \n  }, {\n    key: \"getLanguageMenu\",\n    value: function getLanguageMenu() {\n      var _this3 = this;\n      var editorLanguage = this.getEditorLanguage(); \n      var localizedNameMap = {};\n      var nameArray = languageNames.menuMap[editorLanguage];\n      if (nameArray) {\n        \n        var spokenNameArray = [];\n        if (languageNames.spokenLanguages) {\n          spokenNameArray = languageNames.spokenLanguages[editorLanguage];\n          nameArray = nameArray.concat(spokenNameArray);\n        } \n        \n        \n        \n        \n        \n        nameArray.forEach(function (lang) {\n          localizedNameMap[lang.code] = lang.name;\n        });\n      }\n      return Object.keys(this.LANGUAGE_INFO).map(function (key) {\n        var name = _this3.LANGUAGE_INFO[key].name;\n        var localizedName = localizedNameMap[key];\n        if (localizedName) {\n          name = localizedName;\n        } \n        name = name.charAt(0).toUpperCase() + name.slice(1);\n        return {\n          text: name,\n          value: key\n        };\n      });\n    }\n   \n  }, {\n    key: \"setVoice\",\n    value: function setVoice(args, util) {\n      var state = this._getState(util.target);\n      var voice = args.VOICE; \n      var voiceNum = parseInt(voice, 10);\n      if (!isNaN(voiceNum)) {\n        voiceNum -= 1; \n        voiceNum = MathUtil.wrapClamp(voiceNum, 0, Object.keys(this.VOICE_INFO).length - 1);\n        voice = Object.keys(this.VOICE_INFO)[voiceNum];\n      } \n      if (Object.keys(this.VOICE_INFO).includes(voice)) {\n        state.voiceId = voice;\n      }\n    }\n   \n  }, {\n    key: \"setLanguage\",\n    value: function setLanguage(args) {\n      this.setCurrentLanguage(args.LANGUAGE);\n    }\n   \n  }, {\n    key: \"_stopAllSpeech\",\n    value: function _stopAllSpeech() {\n      this._soundPlayers.forEach(function (player) {\n        player.stop();\n      });\n    }\n   \n  }, {\n    key: \"speakAndWait\",\n    value: function speakAndWait(args, util) {\n      var _this4 = this;\n      \n      var words = Cast.toString(args.WORDS);\n      var locale = this._getSpeechSynthLocale();\n      var state = this._getState(util.target);\n      var gender = this.VOICE_INFO[state.voiceId].gender;\n      var playbackRate = this.VOICE_INFO[state.voiceId].playbackRate; \n      \n      \n      if (this.LANGUAGE_INFO[this.getCurrentLanguage()].singleGender) {\n        gender = 'female';\n        if (state.voiceId === TENOR_ID) {\n          playbackRate = FEMALE_TENOR_RATE;\n        }\n        if (state.voiceId === GIANT_ID) {\n          playbackRate = FEMALE_GIANT_RATE;\n        }\n      }\n      if (state.voiceId === KITTEN_ID) {\n        words = words.replace(/\\S+/g, 'meow');\n        locale = this.LANGUAGE_INFO[this.DEFAULT_LANGUAGE].speechSynthLocale;\n      } \n      var path = \"\".concat(SERVER_HOST, \"/synth\");\n      path += \"?locale=\".concat(locale);\n      path += \"&gender=\".concat(gender);\n      path += \"&text=\".concat(encodeURIComponent(words.substring(0, 128))); \n      var path = \"./gettts.php\";\n      path += \"?lan=zh&spd=5&source=web\";\n      path += \"&gender=\".concat(gender);\n      path += \"&text=\".concat(encodeURIComponent(words.substring(0, 128)));\n      return new Promise(function (resolve) {\n        nets({\n          url: path,\n          timeout: SERVER_TIMEOUT\n        }, function (err, res, body) {\n          if (err) {\n            log.warn(err);\n            return resolve();\n          }\n          if (res.statusCode !== 200) {\n            log.warn(res.statusCode);\n            return resolve();\n          } \n          var sound = {\n            data: {\n              buffer: body.buffer\n            }\n          };\n          _this4.runtime.audioEngine.decodeSoundPlayer(sound).then(function (soundPlayer) {\n            _this4._soundPlayers.set(soundPlayer.id, soundPlayer);\n            soundPlayer.setPlaybackRate(playbackRate); \n            var engine = _this4.runtime.audioEngine;\n            var chain = engine.createEffectChain();\n            chain.set('volume', SPEECH_VOLUME);\n            soundPlayer.connect(chain);\n            soundPlayer.play();\n            soundPlayer.on('stop', function () {\n              _this4._soundPlayers.delete(soundPlayer.id);\n              resolve();\n            });\n          });\n        });\n      });\n    }\n  }, {\n    key: \"VOICE_INFO\",\n    get: function get() {\n      var _ref;\n      return _ref = {}, _defineProperty(_ref, ALTO_ID, {\n        name: formatMessage({\n          id: 'text2speech.alto',\n          default: 'alto',\n          description: 'Name for a voice with ambiguous gender.'\n        }),\n        gender: 'female',\n        playbackRate: 1\n      }), _defineProperty(_ref, TENOR_ID, {\n        name: formatMessage({\n          id: 'text2speech.tenor',\n          default: 'tenor',\n          description: 'Name for a voice with ambiguous gender.'\n        }),\n        gender: 'male',\n        playbackRate: 1\n      }), _defineProperty(_ref, SQUEAK_ID, {\n        name: formatMessage({\n          id: 'text2speech.squeak',\n          default: 'squeak',\n          description: 'Name for a funny voice with a high pitch.'\n        }),\n        gender: 'female',\n        playbackRate: 1.19 \n      }), _defineProperty(_ref, GIANT_ID, {\n        name: formatMessage({\n          id: 'text2speech.giant',\n          default: 'giant',\n          description: 'Name for a funny voice with a low pitch.'\n        }),\n        gender: 'male',\n        playbackRate: 0.84 \n      }), _defineProperty(_ref, KITTEN_ID, {\n        name: formatMessage({\n          id: 'text2speech.kitten',\n          default: 'kitten',\n          description: 'A baby cat.'\n        }),\n        gender: 'female',\n        playbackRate: 1.41 \n      }), _ref;\n    }\n   \n  }, {\n    key: \"LANGUAGE_INFO\",\n    get: function get() {\n      var _ref2;\n      return _ref2 = {}, _defineProperty(_ref2, ARABIC_ID, {\n        name: 'Arabic',\n        locales: ['ar'],\n        speechSynthLocale: 'arb',\n        singleGender: true\n      }), _defineProperty(_ref2, CHINESE_ID, {\n        name: 'Chinese (Mandarin)',\n        locales: ['zh-cn', 'zh-tw'],\n        speechSynthLocale: 'cmn-CN',\n        singleGender: true\n      }), _defineProperty(_ref2, DANISH_ID, {\n        name: 'Danish',\n        locales: ['da'],\n        speechSynthLocale: 'da-DK'\n      }), _defineProperty(_ref2, DUTCH_ID, {\n        name: 'Dutch',\n        locales: ['nl'],\n        speechSynthLocale: 'nl-NL'\n      }), _defineProperty(_ref2, ENGLISH_ID, {\n        name: 'English',\n        locales: ['en'],\n        speechSynthLocale: 'en-US'\n      }), _defineProperty(_ref2, FRENCH_ID, {\n        name: 'French',\n        locales: ['fr'],\n        speechSynthLocale: 'fr-FR'\n      }), _defineProperty(_ref2, GERMAN_ID, {\n        name: 'German',\n        locales: ['de'],\n        speechSynthLocale: 'de-DE'\n      }), _defineProperty(_ref2, HINDI_ID, {\n        name: 'Hindi',\n        locales: ['hi'],\n        speechSynthLocale: 'hi-IN',\n        singleGender: true\n      }), _defineProperty(_ref2, ICELANDIC_ID, {\n        name: 'Icelandic',\n        locales: ['is'],\n        speechSynthLocale: 'is-IS'\n      }), _defineProperty(_ref2, ITALIAN_ID, {\n        name: 'Italian',\n        locales: ['it'],\n        speechSynthLocale: 'it-IT'\n      }), _defineProperty(_ref2, JAPANESE_ID, {\n        name: 'Japanese',\n        locales: ['ja', 'ja-hira'],\n        speechSynthLocale: 'ja-JP'\n      }), _defineProperty(_ref2, KOREAN_ID, {\n        name: 'Korean',\n        locales: ['ko'],\n        speechSynthLocale: 'ko-KR',\n        singleGender: true\n      }), _defineProperty(_ref2, NORWEGIAN_ID, {\n        name: 'Norwegian',\n        locales: ['nb', 'nn'],\n        speechSynthLocale: 'nb-NO',\n        singleGender: true\n      }), _defineProperty(_ref2, POLISH_ID, {\n        name: 'Polish',\n        locales: ['pl'],\n        speechSynthLocale: 'pl-PL'\n      }), _defineProperty(_ref2, PORTUGUESE_BR_ID, {\n        name: 'Portuguese (Brazilian)',\n        locales: ['pt-br'],\n        speechSynthLocale: 'pt-BR'\n      }), _defineProperty(_ref2, PORTUGUESE_ID, {\n        name: 'Portuguese (European)',\n        locales: ['pt'],\n        speechSynthLocale: 'pt-PT'\n      }), _defineProperty(_ref2, ROMANIAN_ID, {\n        name: 'Romanian',\n        locales: ['ro'],\n        speechSynthLocale: 'ro-RO',\n        singleGender: true\n      }), _defineProperty(_ref2, RUSSIAN_ID, {\n        name: 'Russian',\n        locales: ['ru'],\n        speechSynthLocale: 'ru-RU'\n      }), _defineProperty(_ref2, SPANISH_ID, {\n        name: 'Spanish (European)',\n        locales: ['es'],\n        speechSynthLocale: 'es-ES'\n      }), _defineProperty(_ref2, SPANISH_419_ID, {\n        name: 'Spanish (Latin American)',\n        locales: ['es-419'],\n        speechSynthLocale: 'es-US'\n      }), _defineProperty(_ref2, SWEDISH_ID, {\n        name: 'Swedish',\n        locales: ['sv'],\n        speechSynthLocale: 'sv-SE',\n        singleGender: true\n      }), _defineProperty(_ref2, TURKISH_ID, {\n        name: 'Turkish',\n        locales: ['tr'],\n        speechSynthLocale: 'tr-TR',\n        singleGender: true\n      }), _defineProperty(_ref2, WELSH_ID, {\n        name: 'Welsh',\n        locales: ['cy'],\n        speechSynthLocale: 'cy-GB',\n        singleGender: true\n      }), _ref2;\n    }\n   \n  }, {\n    key: \"DEFAULT_LANGUAGE\",\n   \n    get: function get() {\n      return ENGLISH_ID;\n    }\n  }], [{\n    key: \"STATE_KEY\",\n    get: function get() {\n      return 'Scratch.text2speech';\n    }\n   \n  }, {\n    key: \"DEFAULT_TEXT2SPEECH_STATE\",\n    get: function get() {\n      return {\n        voiceId: ALTO_ID\n      };\n    }\n  }]);\n  return Scratch3Text2SpeechBlocks;\n}();\nmodule.exports = Scratch3Text2SpeechBlocks;\n })